apply plugin: 'org.sonarqube'
apply plugin: "com.github.kt3k.coveralls"
apply plugin: 'checkstyle'
apply plugin: 'jacoco'

jacoco {
  toolVersion = pluginVersion.jacoco
}

task jacocoTestReport(type: JacocoReport, dependsOn: "connectedDebugAndroidTest") {
  group = "Reporting"
  description = "Generate Jacoco coverage reports after running tests."
  reports {
    xml.enabled = true
    html.enabled = true
  }
  classDirectories = fileTree(
      dir: './build/intermediates/classes/debug',
      excludes: ['**/R*.class',
                 '**/*$InjectAdapter.class',
                 '**/*$ModuleAdapter.class',
                 '**/*$ViewInjector*.class'
      ])
  executionData = files("${project.buildDir}/jacoco/test.exec")
}

sonarqube {
  properties {
    property "sonar.exclusions", "${project.rootDir}/navigation/app"
    property "sonar.java.coveragePlugin", "jacoco"
    property "sonar.jacoco.reportPaths", "${project.buildDir}/jacoco/test.exec"
    property "sonar.links.homepage", "https://github.com/mapbox/mapbox-navigation-android"
  }
}